#!/bin/sh
#PBS -N coupling2D
#PBS -j oe
#PBS -l walltime=00:05:00,nodes=16:ppn=2

NPX=4
NPY=4
NDX=7
NDY=9 
STEPS=3

let "NPROC=NPX*NPY"

cd $PBS_O_WORKDIR
rm -f writer_*.bp
rm -f reader_*.bp
rm -f reader_*.txt
rm -f log.*
rm -f coupling2D.[oe][0-9]*
echo "NPROC=$NPROC ($NPX x $NPY)   array size = $NDX x $NDY   steps = $STEPS" >& log.job
mpirun -np $NPROC ./coupling_writer_2D writer $NPX $NPY $NDX $NDY $STEPS >& log.writer2D &
mpirun -np $NPROC ./coupling_reader_2D writer $NPX $NPY $NDX $NDY $STEPS >& log.reader2D &
wait

